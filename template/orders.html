<!DOCTYPE html>

{% load static %}
{% load cart %}
{% load custom_filter %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My orders</title>
     <link href="{%  static  'css/base1.css'  %}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">


    <style>
    body {
        background-color: rgb(204, 209, 218);
    }


    .as {
        text-decoration: none;
        display: inline-block;
        margin-left: 43%;

    }

    .as ,a:hover {
        background-color: #ddd;
        color: black;
    }

    .previous {
        font-size:23px;
        background-color: #FF4500;
        color: white;
    }

    .round {
        border-radius: 50%;

    </style>


     <script>
        function showAlert() {
             alert ("This order has not been confirmed yet!");
        }

        function AlertMsg() {
             alert ("This book has already been returned!");
        }



}




     </script>
</head>


<body>
<div class="container" style="background-color: rgb(218, 235, 187);font-size: 22px; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif">
<div class="border rounded p-4 m-4">
    <p class="display-4 pl-4 ml-4">Your Orders</p>
    <hr>

    <table class="table">
        <thead>
            <tr>
                <th>S.No</th>
                <th>Image</th>
                <th>Product</th>
                <th>Date</th>
                <th></th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
                <th>status</th>
                <th>return_status</th>
                <th>Return</th>

            </tr>
        </thead>
        <tbody>

            {% for order in orders %}

            <tr>
                <td>{{forloop.counter}}</td>
                <td><img style="height: 100px" class="rounded-circle" src="{{order|find_by_image}}" alt="product"></td>
                <td>{{order|find_by_price}}</td>
                <td>{{order.date}}<td>
                <td>{{order.price|currency}}</td>
                <td>{{order.quantity}}</td>
                <td>{{order.quantity|multiply:order.price|currency}}</td>

                {%if order.status %}
                <td><small style="color:green">successful</small></td>
                {%else%}
                <td><small style="color:red">pending</small></td>
                 {%endif%}

                {%if order.status %}
                     {%if order.return_status %}
                        <td><small style="color:green">returned</small></td>
                     {%else%}
                        <td><small style="color:red">kept</small></td>
                    {%endif%}
                {%else%}
                    <td></td>
                {% endif %}

                {%if order.status %}
                <form action="/returnbook" method="post" id="systemform">
                          {% csrf_token %}
                    {%if order.return_status %}
                        <td><button type="button" name="system" value="{{order.date}}" class="btn btn-info" style="float:left;font-size: 20px;" onclick="AlertMsg()">return</button></td>
                    {%else%}

                        <td><a href="{% url 'returnbook' %}"><button name="system" value="{{order.id}}" form="systemform" type="submit" class="btn btn-info" style="float:left;font-size: 20px;">return</button></a></td>

                    {% endif %}

                {%else%}



                    <td><button name="system" value="{{order.date}}" type="button" class="btn btn-info" style="float:left;font-size: 20px;" onclick="showAlert()">return</button></td>
                 </form>
                    {% endif %}

            </tr>
            {% endfor %}

        </tbody>

    </table>

    <hr>

    <br>

</div>
</div>

<div>
   <a href="{% url 'Home' %}" class="btn btn-warning" style="margin-left:48%; margin-bottom: 2%; font-size:22px"> &laquo; Previous</a>
</div>

</body>
</html>